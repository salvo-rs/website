---
title: Библиотека для работы с датой и временем в Rust
---

# Chrono: Библиотека для работы с датой и временем в Rust

[Chrono](https://docs.rs/chrono/latest/chrono/) предоставляет все необходимые функции для корректных операций с датами и временем в пролептическом григорианском календаре:

- Тип `DateTime` по умолчанию учитывает часовые пояса, также существуют отдельные типы без привязки к часовому поясу.
- Операции, которые могут привести к недопустимой или неоднозначной дате и времени, возвращают `Option` или `MappedLocalTime`.
- Настраиваемый парсинг и форматирование с использованием синтаксиса, вдохновлённого strftime.
- Часовой пояс `Local` работает с текущим локальным часовым поясом операционной системы.
- Типы и операции реализованы с разумной эффективностью.
- Чтобы избежать увеличения размера бинарного файла, Chrono по умолчанию не включает данные о часовых поясах. Для полной поддержки часовых поясов используйте сопутствующие крейты `Chrono-TZ` или `tzfile`.

## Возможности

[Chrono](https://docs.rs/chrono/latest/chrono/) поддерживает различные среды выполнения и операционные системы с набором функций, которые можно включать или отключать.

### Функции по умолчанию:

- `alloc`: Включает функции, зависящие от аллокации (в основном форматирование строк).
- `std`: Включает функции, зависящие от стандартной библиотеки. Является надмножеством `alloc`, добавляя взаимодействие с типами и трейтами стандартной библиотеки.
- `clock`: Включает чтение локального часового пояса (`Local`). Является надмножеством `now`.
- `now`: Включает чтение системного времени (`now`).
- `wasmbind`: Предоставляет интерфейс к JS Date API для цели wasm32.

### Дополнительные функции:

- `serde`: Включает сериализацию/десериализацию через serde.
- `rkyv`: Устарело, используйте функции `rkyv-*`.
- `rkyv-16`, `rkyv-32`, `rkyv-64`: Включают сериализацию/десериализацию через rkyv с использованием 16-битных, 32-битных или 64-битных целых чисел соответственно.
- `rkyv-validation`: Включает поддержку валидации rkyv с использованием bytecheck.
- `arbitrary`: Создаёт произвольные экземпляры типов с помощью крейта Arbitrary.
- `unstable-locales`: Включает локализацию. Добавляет различные методы с суффиксом `_localized`.

## Обзор

### Разница во времени / Длительность

Chrono предоставляет тип `TimeDelta` для представления величины временного промежутка. Это "точная" длительность, представленная в секундах и наносекундах, и не представляющая "номинальные" компоненты, такие как дни или месяцы.

Тип `TimeDelta` ранее назывался `Duration` (доступен как псевдоним типа). Заметное отличие от аналогичного `core::time::Duration` заключается в том, что он имеет знаковое значение, а не беззнаковое.

### Дата и время

Chrono предоставляет тип `DateTime` для представления даты и времени в часовом поясе.

`DateTime` учитывает часовой пояс и должен быть создан из объекта `TimeZone`, который определяет, как локальная дата преобразуется в UTC и обратно. Существует три известные реализации `TimeZone`:

- `Utc` определяет часовой пояс UTC. Он наиболее эффективен.
- `Local` определяет локальный часовой пояс системы.
- `FixedOffset` определяет произвольный часовой пояс с фиксированным смещением, например UTC+09:00 или UTC-10:30.

Значения `DateTime` с разными типами `TimeZone` различны и не могут смешиваться, но могут быть преобразованы друг в друга с помощью метода `DateTime::with_timezone`.

Вы можете получить текущую дату и время в часовом поясе UTC (`Utc::now()`) или в локальном часовом поясе (`Local::now()`).

```rust
use chrono::prelude::*;

let utc: DateTime<Utc> = Utc::now(); // например, `2014-11-28T12:45:59.324310806Z`
let local: DateTime<Local> = Local::now(); // например, `2014-11-28T21:45:59.324310806+09:00`
```

Кроме того, вы можете создать собственную дату и время:

```rust
use chrono::offset::MappedLocalTime;
use chrono::prelude::*;

let dt = Utc.with_ymd_and_hms(2014, 7, 8, 9, 10, 11).unwrap(); // `2014-07-08T09:10:11Z`
```

### Форматирование и парсинг

Форматирование выполняется с помощью метода `format`, формат которого эквивалентен знакомому формату strftime.

Метод по умолчанию `to_string` и спецификатор `{:?}` также дают разумное представление. Chrono также предоставляет методы `to_rfc2822` и `to_rfc3339` для распространённых форматов.

Chrono теперь также предоставляет форматирование дат практически на любом языке без дополнительных C-библиотек. Эта функция доступна под функцией `unstable-locales`:

```rust
use chrono::prelude::*;

let dt = Utc.with_ymd_and_hms(2014, 11, 28, 12, 0, 9).unwrap();
assert_eq!(dt.format("%Y-%m-%d %H:%M:%S").to_string(), "2014-11-28 12:00:09");
assert_eq!(dt.format_localized("%A %e %B %Y, %T", Locale::fr_BE).to_string(), 
           "vendredi 28 novembre 2014, 12:00:09");
```

Парсинг может быть выполнен двумя способами:

1. Стандартный трейт `FromStr` (и метод `parse` для строк) может использоваться для разбора значений `DateTime<FixedOffset>`, `DateTime<Utc>` и `DateTime<Local>`.
2. `DateTime::parse_from_str` разбирает дату и время со смещением и возвращает `DateTime<FixedOffset>`.

```rust
use chrono::prelude::*;

let dt = "2014-11-28T12:00:09Z".parse::<DateTime<Utc>>().unwrap();
let fixed_dt = DateTime::parse_from_str("2014-11-28 21:00:09 +09:00", "%Y-%m-%d %H:%M:%S %z").unwrap();
```

### Преобразование в/из меток времени Unix

Создайте `DateTime<Utc>` из метки времени UNIX с помощью `DateTime::from_timestamp(seconds, nanoseconds)`.

Получите метку времени (в секундах) из `DateTime` с помощью `DateTime.timestamp`. Дополнительно вы можете получить дополнительное количество наносекунд с помощью `DateTime.timestamp_subsec_nanos`.

```rust
use chrono::{DateTime, Utc};

// Создание даты и времени из метки времени:
let dt: DateTime<Utc> = DateTime::from_timestamp(1_500_000_000, 0).unwrap();
assert_eq!(dt.to_rfc2822(), "Fri, 14 Jul 2017 02:40:00 +0000");

// Получение значения метки времени из даты и времени:
let dt = DateTime::parse_from_rfc2822("Fri, 14 Jul 2017 02:40:00 +0000").unwrap();
assert_eq!(dt.timestamp(), 1_500_000_000);
```

## Ограничения

- Поддерживается только пролептический григорианский календарь (т.е. расширенный для поддержки дат до нашей эры).
- Типы дат ограничены приблизительно +/- 262 000 лет от нашей эры.
- Типы времени ограничены точностью до наносекунд.
- Секунды координации могут быть представлены, но Chrono не поддерживает их полностью.
{/* Auto generated, origin file hash:10bcf1127b3b63767462c43c36ecf9da */}