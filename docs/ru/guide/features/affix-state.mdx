# Прикрепление общих данных состояния в запросах

import { Tab, Tabs } from '@rspress/core/theme';

Промежуточное ПО Affix State используется для добавления общих данных в Depot.
Чтобы использовать функцию Affix State, необходимо включить функцию `affix-state` в Cargo.toml.

## Анализ функции
Affix State предоставляет простой способ обмена данными во время обработки запроса. Это позволяет вам:

- Внедрять глобальные конфигурации или общие данные при настройке маршрутов
- Получать доступ к этим данным через Depot в любом обработчике
- Поддерживать любой клонируемый тип в качестве данных состояния

## Сравнение с другими фреймворками для быстрого понимания концепции
| Фреймворк | Язык | Подход к управлению состоянием |
|-----------|------|--------------------------------|
| Salvo (Affix State) | Rust | Хранит и получает доступ через Depot, поддерживает множество типов |
| Axum | Rust | Хранит состояние через Extension, похожий подход, но с другим использованием |
| Actix-web | Rust | Использует App Data и Web::Data для обмена состоянием |
| Gin | Go | Использует context.Set и context.Get для хранения и получения данных |
| Echo | Go | Использует context.Set и context.Get для управления общим состоянием |
| Spring | Java | Использует ApplicationContext или аннотации @Bean для управления зависимостями |
| Quarkus | Java | Использует механизмы CDI и внедрения зависимостей |
| Express.js | JavaScript | Использует app.locals или req.app.locals для хранения глобального состояния |
| Nest.js | JavaScript | Использует систему внедрения зависимостей для управления общими сервисами |
| Koa.js | JavaScript | Использует ctx.state для хранения состояния уровня запроса |

## Распространенные случаи использования

- Общий пул подключений к базе данных
- Общий доступ к конфигурации приложения
- Общий доступ к экземпляру кэша
- Общий доступ к API-клиенту
- Глобальные счетчики или отслеживание состояния

Преимущество Affix State заключается в его простоте и гибкости, позволяя легко обмениваться данными любого типа между различными маршрутами и обработчиками без написания большого количества шаблонного кода.
_**Пример кода**_

<Tabs>
  <Tab label="main.rs">
  ```rust file="<root>/codes/affix-state/src/main.rs"
  ```
  </Tab>
  <Tab label="Cargo.toml">
  ```toml file="<root>/codes/affix-state/Cargo.toml"
  ```
  </Tab>
</Tabs>
{/* Auto generated, origin file hash:ab33e7002b7895dc8f4c574665f3af4f */}