# Отправка файлов

Salvo предоставляет несколько способов отправки файлов:

import { Tab, Tabs } from '@rspress/core/theme';

### NamedFile

Salvo предлагает `salvo::fs::NamedFile`, который позволяет эффективно отправлять файлы клиенту. Он не загружает весь файл в кэш, а загружает и отправляет только ту часть содержимого, которая запрашивается в заголовке `Range`.

Фактически, использование `Response::send_file` — это упрощённый способ работы с `NamedFile`. Если вам требуется более тонкий контроль над отправляемым файлом, вы можете использовать `NamedFileBuilder`.

Создать `NamedFileBuilder` можно с помощью `NamedFile::builder`:

```rust
#[handler]
async fn send_file(req: &mut Request, res: &mut Response) {
    let builder = NamedFile::builder("/file/to/path");
}
```

Можно выполнить некоторые настройки, а затем отправить файл:

```rust
#[handler]
async fn send_file(req: &mut Request, res: &mut Response) {
    NamedFile::builder("/file/to/path").attached_name("image.png").send(req.headers(), res).await;
}
```

### Serve Static

Промежуточное ПО для обслуживания статических или встроенных файлов.

- `StaticDir` обеспечивает поддержку статических локальных папок. В качестве параметра можно передать список из нескольких папок. Например:
<Tabs>
  <Tab label="main.rs">
  ```rust file="<root>/codes/static-dir-list/src/main.rs"
  ```
  </Tab>
  <Tab label="Cargo.toml">
  ```toml file="<root>/codes/static-dir-list/Cargo.toml"
  ```
  </Tab>
</Tabs>
  Если соответствующий файл не найден в первой папке, поиск продолжится во второй.

- Предоставляется поддержка `rust-embed`, например:
<Tabs>
  <Tab label="main.rs">
  ```rust file="<root>/codes/static-embed-files/src/main.rs"
  ```
  </Tab>
  <Tab label="Cargo.toml">
  ```toml file="<root>/codes/static-embed-files/Cargo.toml"
  ```
  </Tab>
</Tabs>
  `with_fallback` позволяет указать файл, который будет использоваться, если запрашиваемый файл не найден. Это может быть полезно, например, для одностраничных веб-приложений.
{/* 本行由工具自动生成,原文哈希值:19063883c45fafc63ab4ff3751ac9892 */}