import { Tab, Tabs } from '@rspress/core/theme';

# Limitation de la concurrence

Le middleware Concurrency Limiter permet de contrôler le nombre de requêtes traitées simultanément. Pour les détails de l'API, veuillez [consulter la documentation](https://docs.rs/salvo_extra/latest/salvo_extra/concurrency_limiter/index.html).

## Scénarios d'application

Le limiteur de concurrence est particulièrement utile dans les situations suivantes :

- **Protection des sites à fort trafic** : Limite le nombre de requêtes traitées simultanément lors de pics de trafic pour éviter la surcharge du serveur.
- **Contrôle des opérations intensives en ressources** : Restreint la concurrence des opérations consommatrices de ressources comme le téléchargement de fichiers ou l'écriture en base de données.
- **Limitation des appels aux API tierces** : Contrôle le nombre de requêtes simultanées lors de l'appel à des services externes avec des limites de débit.

## Principales fonctions

- **Prévention de la surcharge du serveur** : Maintient la stabilité du serveur pendant les périodes de trafic élevé en limitant les requêtes concurrentes.
- **Amélioration de la fiabilité du système** : Évite les plantages dus à l'épuisement des ressources.
- **Optimisation de l'allocation des ressources** : Garantit que les services critiques disposent de suffisamment de ressources pour traiter les requêtes.

## Mode d'emploi

Il suffit d'ajouter le middleware `max_concurrency(n)` à la route, où `n` est le nombre maximal de requêtes simultanées autorisées. Les requêtes dépassant cette limite recevront une réponse `503 Service Unavailable`.

_**Exemple de code**_

<Tabs>
  <Tab label="main.rs">
  ```rust file="<root>/codes/concurrency-limiter/src/main.rs"
  ```
  </Tab>
  <Tab label="Cargo.toml">
  ```toml file="<root>/codes/concurrency-limiter/Cargo.toml"
  ```
  </Tab>
</Tabs>
{/* 本行由工具自动生成,原文哈希值:e608fa24b412ca88671cf77efea06bad */}