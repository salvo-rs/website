---
title: Bibliothèque cliente HTTP Rust
---

# Reqwest : Bibliothèque cliente HTTP Rust

[Reqwest](https://docs.rs/reqwest/latest/reqwest/) est une bibliothèque cliente HTTP de haut niveau qui simplifie le traitement des requêtes HTTP et offre de nombreuses fonctionnalités courantes :

- Prise en charge des API asynchrones et bloquantes
- Gestion de divers types de corps de requête : texte brut, JSON, formulaires encodés en URL, formulaires multipart
- Politique de redirection personnalisable
- Prise en charge des proxys HTTP
- Chiffrement TLS par défaut
- Gestion des cookies

## Utilisation de base

### Effectuer une requête GET

Pour une requête unique, vous pouvez utiliser la méthode raccourcie `get` :

```rust
let body = reqwest::get("https://www.rust-lang.org")
    .await?
    .text()
    .await?;

println!("body = {body:?}");
```

> Remarque : Si vous prévoyez d'effectuer plusieurs requêtes, il est préférable de créer un `Client` et de le réutiliser pour bénéficier des avantages du pool de connexions.

```rust
let client = reqwest::Client::new();
let res = client.get("https://www.rust-lang.org")
    .send()
    .await?;
```

### Effectuer une requête POST

Utilisez la méthode `body()` pour définir le corps de la requête :

```rust
let client = reqwest::Client::new();
let res = client.post("http://httpbin.org/post")
    .body("contenu spécifique à envoyer")
    .send()
    .await?;
```

### Données de formulaire

L'envoi de données de formulaire est une exigence courante, vous pouvez utiliser tout type sérialisable en données de formulaire :

```rust
// Cela enverra une requête POST avec le corps `foo=bar&baz=quux`
let params = [("foo", "bar"), ("baz", "quux")];
let client = reqwest::Client::new();
let res = client.post("http://httpbin.org/post")
    .form(&params)
    .send()
    .await?;
```

### Données JSON

Envoyez facilement des données JSON via la méthode `json` (nécessite la fonctionnalité `json`) :

```rust
// Cela enverra une requête POST avec le corps `{"lang":"rust","body":"json"}`
let mut map = HashMap::new();
map.insert("lang", "rust");
map.insert("body", "json");

let client = reqwest::Client::new();
let res = client.post("http://httpbin.org/post")
    .json(&map)
    .send()
    .await?;
```

### Traitement des réponses

Les réponses peuvent être traitées de plusieurs manières :

```rust
let res = client.get("https://www.rust-lang.org").send().await?;

// Obtenir le code d'état
let status = res.status();

// Obtenir les en-têtes de réponse
let content_type = res.headers().get("content-type").unwrap();

// Lire le corps de la réponse sous forme de texte
let body = res.text().await?;

// Ou le parser en JSON
let json: serde_json::Value = res.json().await?;
```

## Fonctionnalités avancées

### Politique de redirection

Par défaut, le client gère automatiquement les redirections HTTP, en suivant jusqu'à 10 sauts. Vous pouvez personnaliser ce comportement avec `ClientBuilder` :

```rust
let custom_client = reqwest::Client::builder()
    .redirect(reqwest::redirect::Policy::none()) // Désactiver les redirections
    .build()?;
```

### Prise en charge des cookies

Activez le stockage et l'envoi automatiques des cookies de session via `ClientBuilder` :

```rust
let client = reqwest::Client::builder()
    .cookie_store(true)
    .build()?;
```

### Configuration du proxy

Le proxy système est activé par défaut, recherchant les paramètres de proxy HTTP ou HTTPS dans les variables d'environnement :

- `HTTP_PROXY` ou `http_proxy` : proxy pour les connexions HTTP
- `HTTPS_PROXY` ou `https_proxy` : proxy pour les connexions HTTPS
- `ALL_PROXY` ou `all_proxy` : proxy pour les deux types de connexions

Vous pouvez également définir explicitement un proxy via le code :

```rust
let proxy = reqwest::Proxy::http("https://secure.example")?;
let client = reqwest::Client::builder()
    .proxy(proxy)
    .build()?;

// Ou désactiver le proxy
let client = reqwest::Client::builder()
    .no_proxy()
    .build()?;
```

### Configuration TLS

Le client utilise TLS par défaut pour se connecter aux cibles HTTPS :

```rust
// Ajouter un certificat serveur supplémentaire
let cert = reqwest::Certificate::from_pem(&cert_bytes)?;
let client = reqwest::Client::builder()
    .add_root_certificate(cert)
    .build()?;

// Configurer un certificat client
let identity = reqwest::Identity::from_pkcs12_der(&pkcs12_der, "password")?;
let client = reqwest::Client::builder()
    .identity(identity)
    .build()?;
```

### Configuration des délais d'attente

Vous pouvez configurer des délais d'attente pour les requêtes :

```rust
let client = reqwest::Client::builder()
    .timeout(std::time::Duration::from_secs(10))
    .build()?;
```

## Fonctionnalités optionnelles

Reqwest propose diverses fonctionnalités optionnelles, activables ou désactivables via les fonctionnalités Cargo :

- `http2` (activé par défaut) : prise en charge de HTTP/2
- `default-tls` (activé par défaut) : fournit la prise en charge TLS pour HTTPS
- `rustls-tls` : fournit les fonctionnalités TLS via rustls
- `blocking` : fournit une API cliente bloquante
- `json` : fournit la sérialisation et désérialisation JSON
- `multipart` : fournit les fonctionnalités de formulaire multipart
- `cookies` : fournit la prise en charge des sessions de cookies
- `gzip`, `brotli`, `deflate`, `zstd` : prise en charge de la décompression de divers corps de réponse
- `socks` : fournit la prise en charge du proxy SOCKS5

## API bloquante

Lorsque les opérations asynchrones ne sont pas nécessaires, vous pouvez utiliser l'API bloquante (nécessite la fonctionnalité `blocking`) :

```rust
let body = reqwest::blocking::get("https://www.rust-lang.org")?.text()?;

let client = reqwest::blocking::Client::new();
let res = client.post("http://httpbin.org/post")
    .json(&map)
    .send()?;
```
{/* Auto generated, origin file hash:1611fb82ca7d0449dc610129105100bc */}