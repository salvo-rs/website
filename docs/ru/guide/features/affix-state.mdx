# Состояние Affix - общие данные в запросе

import { Tab, Tabs } from 'rspress/theme';
import MainCode from '../../../../codes_md/affix-state/src/main.mdx';
import CargoCode from '../../../../codes_md/affix-state/Cargo.mdx';

Промежуточное ПО Affix State используется для добавления общих данных в Depot.
Для использования функции Affix State необходимо включить функцию `affix-state` в Cargo.toml.

## Разбор функциональности
Affix State предоставляет простой способ обмена данными в процессе обработки запроса. Он позволяет вам:

- Вводить глобальные настройки или общие данные на этапе конфигурации маршрута
- Получать доступ к этим данным через Depot в любом обработчике
- Поддерживать любой клонируемый тип в качестве данных состояния

## Сравнение с другими фреймворками для быстрого понимания концепции
| Фреймворк | Язык | Способ управления состоянием |
|-----------|------|-----------------------------|
| Salvo (Affix State) | Rust | Хранение и доступ через Depot, поддержка различных типов |
| Axum | Rust | Хранение состояния через Extension, аналогично, но с другим способом использования |
| Actix-web | Rust | Использование App Data и Web::Data для общего состояния |
| Gin | Go | Использование context.Set и context.Get для доступа к данным |
| Echo | Go | Использование context.Set и context.Get для управления общим состоянием |
| Spring | Java | Использование ApplicationContext или аннотации @Bean для управления зависимостями |
| Quarkus | Java | Использование CDI и механизма внедрения зависимостей |
| Express.js | JavaScript | Использование app.locals или req.app.locals для хранения глобального состояния |
| Nest.js | JavaScript | Использование системы внедрения зависимостей для управления общими сервисами |
| Koa.js | JavaScript | Использование ctx.state для хранения состояния на уровне запроса |

## Типичные сценарии использования

- Общий пул подключений к базе данных
- Общий конфигурация приложения
- Общий экземпляр кэша
- Общий API-клиент
- Глобальные счетчики или отслеживание состояния

Преимущество Affix State заключается в его простоте и гибкости, что позволяет легко обмениваться данными любого типа между различными маршрутами и обработчиками без большого количества шаблонного кода.
_**Пример кода**_

<Tabs>
  <Tab label="main.rs">
    <MainCode/>
  </Tab>
  <Tab label="Cargo.toml">
    <CargoCode/>
  </Tab>
</Tabs>
{/* 本行由工具自动生成,原文哈希值:983c6e0b4ca9ff5e194da5a41d8d46f7 */}