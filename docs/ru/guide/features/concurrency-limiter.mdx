import { Tab, Tabs } from '@rspress/core/theme';

# Ограничение количества одновременных запросов

Промежуточное ПО Concurrency Limiter позволяет контролировать количество одновременно обрабатываемых запросов. Подробное описание API смотрите в [документации](https://docs.rs/salvo_extra/latest/salvo_extra/concurrency_limiter/index.html).

## Сценарии применения

Ограничитель одновременных запросов особенно полезен в следующих ситуациях:

- **Защита сайтов с высокой нагрузкой**: ограничение количества одновременно обрабатываемых запросов при резком росте трафика для предотвращения перегрузки сервера
- **Контроль ресурсоёмких операций**: ограничение количества одновременных операций, таких как загрузка файлов или запись в базу данных
- **Ограничение вызовов сторонних API**: контроль количества одновременных запросов при работе с внешними сервисами, имеющими ограничения по частоте запросов

## Основные функции

- **Предотвращение перегрузки сервера**: поддержание стабильной работы сервера в периоды пиковой нагрузки за счёт ограничения одновременных запросов
- **Повышение надёжности системы**: предотвращение сбоев системы из-за исчерпания ресурсов
- **Оптимизация распределения ресурсов**: обеспечение достаточных ресурсов для обработки запросов критически важных служб

## Способ использования

Достаточно добавить промежуточное ПО `max_concurrency(n)` к маршруту, где `n` — максимально допустимое количество одновременных запросов. Запросы, превышающие этот лимит, будут получать ответ `503 Service Unavailable`.

_**Пример кода**_

<Tabs>
  <Tab label="main.rs">
  ```rust file="<root>/codes/concurrency-limiter/src/main.rs"
  ```
  </Tab>
  <Tab label="Cargo.toml">
  ```toml file="<root>/codes/concurrency-limiter/Cargo.toml"
  ```
  </Tab>
</Tabs>
{/* 本行由工具自动生成,原文哈希值:e608fa24b412ca88671cf77efea06bad */}