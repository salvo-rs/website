# Отправка файлов

Salvo предлагает несколько способов отправки файлов:

import { Tab, Tabs } from '@rspress/core/theme';

### NamedFile

Salvo предоставляет `salvo::fs::NamedFile`, который позволяет эффективно отправлять файлы клиентам. Он не загружает весь файл в память, а читает и отправляет только те части, которые запрашивает клиент на основе заголовка `Range`.

На практике использование `Response::send_file` является упрощённым способом применения `NamedFile`. Если вам требуется более детальный контроль над отправкой файлов, вы можете использовать `NamedFileBuilder`.

Создать `NamedFileBuilder` можно через `NamedFile::builder`:

```rust
#[handler]
async fn send_file(req: &mut Request, res: &mut Response) {
    let builder = NamedFile::builder("/file/to/path");
}
```

После настройки билдера вы можете отправить файл:

```rust
#[handler]
async fn send_file(req: &mut Request, res: &mut Response) {
    NamedFile::builder("/file/to/path").attached_name("image.png").send(req.headers(), res).await;
}
```

### Статическое обслуживание

Промежуточное ПО для обслуживания статических или встроенных файлов.

- `StaticDir` обеспечивает поддержку обслуживания статических файлов из локальных каталогов. Вы можете передать список из нескольких каталогов в качестве аргументов. Например:
<Tabs>
  <Tab label="main.rs">
  ```rust file="<root>/codes/static-dir-list/src/main.rs"
  ```
  </Tab>
  <Tab label="Cargo.toml">
  ```toml file="<root>/codes/static-dir-list/Cargo.toml"
  ```
  </Tab>
</Tabs>
  Если файл не найден в первом каталоге, он будет искаться во втором.

- Обеспечивает поддержку `rust-embed`. Например:
<Tabs>
  <Tab label="main.rs">
  ```rust file="<root>/codes/static-embed-files/src/main.rs"
  ```
  </Tab>
  <Tab label="Cargo.toml">
  ```toml file="<root>/codes/static-embed-files/Cargo.toml"
  ```
  </Tab>
</Tabs>
  Метод `with_fallback` позволяет указать резервный файл для обслуживания, когда запрашиваемый файл не найден. Это особенно полезно для одностраничных приложений (SPA).
{/* Auto generated, origin file hash:b0d7ec4cd7a0db7f38dc82b19bff22c8 */}