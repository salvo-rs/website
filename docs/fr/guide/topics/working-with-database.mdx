# Utilisation des bases de données

### [Diesel](https://diesel.rs/)

```rust
use diesel::prelude::*;
use diesel::r2d2::{ConnectionManager, Pool, PoolError, PooledConnection};
use once_cell::sync::OnceCell;
use salvo::prelude::*;

const DB_URL: &str = "postgres://benchmarkdbuser:benchmarkdbpass@tfb-database/hello_world";
type PgPool = Pool<ConnectionManager<PgConnection>>;

static DB_POOL: OnceCell<PgPool> = OnceCell::new();

fn connect() -> Result<PooledConnection<ConnectionManager<PgConnection>>, PoolError> {
    DB_POOL.get().unwrap().get()
}
fn build_pool(database_url: &str, size: u32) -> Result<PgPool, PoolError> {
    let manager = ConnectionManager::<PgConnection>::new(database_url);
    diesel::r2d2::Pool::builder()
        .max_size(size)
        .min_idle(Some(size))
        .test_on_check_out(false)
        .idle_timeout(None)
        .max_lifetime(None)
        .build(manager)
}

fn main() {
    DB_POOL
        .set(build_pool(&DB_URL, 10).expect(&format!("Error connecting to {}", &DB_URL)))
        .ok();
}

#[handler]
async fn show_article(req: &mut Request, res: &mut Response) -> Result<(), Error> {
    let id: i64 = req.param::<i64>("id").unwrap_or_default();
    let conn = connect()?;
    let article = articles::table.find(id).first::<Article>(&conn)?;
    res.render(Json(row));
    Ok(())
}
```

### [Sqlx](https://github.com/launchbadge/sqlx)

import { Tab, Tabs } from '@rspress/core/theme';

<Tabs>
<Tab label="main.rs">
```rust file="<root>/codes/db-postgres-sqlx/src/main.rs"
```
</Tab>
<Tab label="Cargo.toml">
```toml file="<root>/codes/db-postgres-sqlx/Cargo.toml"
```
</Tab>
</Tabs>

### [rbatis](https://github.com/rbatis/rbatis)

<Tabs>
<Tab label="main.rs">
```rust file="<root>/codes/db-mysql-rbatis/src/main.rs"
```
</Tab>
<Tab label="Cargo.toml">
```toml file="<root>/codes/db-mysql-rbatis/Cargo.toml"
```
</Tab>
</Tabs>

## [SeaORM](https://www.sea-ql.org/SeaORM/)

SeaORM est un ORM asynchrone et dynamique qui offre une prise en charge robuste des bases de données relationnelles, incluant les relations entre entités, un système de migration et un constructeur de requêtes complet garantissant la sûreté des types. Il convient particulièrement aux projets de taille moyenne à grande nécessitant un ORM complet.

## [Tokio ORM (Toasty)](https://github.com/tokio-rs/toasty)

Toasty est un ORM développé par l'équipe Tokio, actuellement en développement actif. Il se concentre sur la fourniture d'une solution ORM étroitement intégrée à l'écosystème Tokio. Il peut être adapté aux projets reposant sur Tokio et ouverts à l'adoption de technologies émergentes.

## [SurrealDB Rust SDK](https://surrealdb.com/docs/sdk/rust)

Le SDK Rust de SurrealDB permet la connexion à cette base de données multi-modèle, ce qui le rend adapté aux applications nécessitant de gérer des données de type graphe, document et relationnel. C'est un excellent choix pour les projets nécessitant des modèles de données flexibles.
{/* Auto generated, origin file hash:b866ce69ac7cb1788214d2e481e99fd0 */}