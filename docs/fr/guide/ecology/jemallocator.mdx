---
title: Alternatives d'Allocateurs Mémoire pour Rust
---

# Jemallocator : Alternative d'Allocateur Mémoire Jemalloc pour Rust

:::tip
L'allocateur par défaut peut parfois présenter des retards dans la libération de la mémoire. Il est recommandé d'utiliser (jemallocator)[https://docs.rs/tikv-jemallocator/latest/tikv_jemallocator/] comme allocateur global en remplacement de l'allocateur par défaut.
:::

(jemallocator)[https://docs.rs/tikv-jemallocator/latest/tikv_jemallocator/] est une bibliothèque liée à l'allocateur mémoire jemalloc. Elle fournit le type unitaire `Jemalloc`, qui implémente l'API d'allocateur et peut être configuré comme `#[global_allocator]`.

`tikv-jemallocator` est le successeur du projet `jemallocator`. Ces deux crates sont identiques à l'exception de leur nom. Pour les nouveaux projets, il est recommandé d'utiliser la version `tikv-xxx`.

## Écosystème jemalloc

L'écosystème de support jemalloc est composé des crates suivants :

- **tikv-jemalloc-sys** : Compile et lie jemalloc, exposant ses liaisons C brutes.
- **tikv-jemallocator** : Fournit le type `Jemalloc` qui implémente les traits `GlobalAlloc` et `Alloc`.
- **tikv-jemalloc-ctl** : Encapsulation de haut niveau des API de contrôle et d'introspection de jemalloc (famille de fonctions `mallctl*()` et `MALLCTL NAMESPACE`).

## Utilisation

### Ajouter les dépendances

Pour utiliser tikv-jemallocator, ajoutez-le comme dépendance :

```toml
[dependencies]

[target.'cfg(not(target_env = "msvc"))'.dependencies]
tikv-jemallocator = "0.5"
```

### Configurer comme allocateur global

Pour définir `tikv_jemallocator::Jemalloc` comme allocateur global, ajoutez le code suivant à votre projet :

```rust
#[cfg(not(target_env = "msvc"))]
use tikv_jemallocator::Jemalloc;

#[cfg(not(target_env = "msvc"))]
#[global_allocator]
static GLOBAL: Jemalloc = Jemalloc;
```

C'est tout ! Une fois cette variable statique définie, jemalloc sera utilisé pour toutes les allocations mémoire demandées par le code Rust dans le même programme.

## Avantages

jemalloc est une implémentation malloc à usage général qui se concentre sur :

- La réduction de la fragmentation mémoire
- L'évolutivité dans les scénarios hautement concurrents
- La fourniture de capacités riches d'introspection et de contrôle

Il est particulièrement utile dans les cas suivants :
- Applications à exécution prolongée
- Charges de travail intensives en mémoire
- Services haute performance nécessitant une gestion mémoire fine

## Notes de compatibilité

jemalloc ne prend pas en charge les environnements cibles MSVC, il n'est donc pas disponible lors de l'utilisation de la chaîne d'outils MSVC sous Windows. C'est pourquoi les exemples de code incluent la condition `cfg(not(target_env = "msvc"))`.
{/* Auto generated, origin file hash:97d5bd2f5d44a1facae329972bdc937f */}