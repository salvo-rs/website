# ファイル送信

Salvo では以下の方法でファイルを送信できます：

import { Tab, Tabs } from '@rspress/core/theme';

### NamedFile

Salvo は `salvo::fs::NamedFile` を提供しており、これを使用してクライアントに効率的にファイルを送信できます。ファイル全体をキャッシュに読み込むのではなく、リクエストの `Range` に基づいて部分的な内容を読み込み、クライアントに送信します。

実際には、`Response::send_file` は `NamedFile` の簡易的な使用法です。ファイル送信をより細かく制御する必要がある場合は、`NamedFileBuilder` を使用できます。

`NamedFile::builder` を使用して `NamedFileBuilder` を作成できます：

```rust
#[handler]
async fn send_file(req: &mut Request, res: &mut Response) {
    let builder = NamedFile::builder("/file/to/path");
}
```

設定を行った後、ファイルを送信できます：

```rust
#[handler]
async fn send_file(req: &mut Request, res: &mut Response) {
    NamedFile::builder("/file/to/path").attached_name("image.png").send(req.headers(), res).await;
}
```

### 静的ファイル提供

静的ファイルや埋め込みファイルをサービスとして提供するミドルウェアです。

- `StaticDir` はローカルの静的フォルダをサポートします。複数のフォルダのリストを引数として渡すことができます。例：
<Tabs>
  <Tab label="main.rs">
  ```rust file="<root>/codes/static-dir-list/src/main.rs"
  ```
  </Tab>
  <Tab label="Cargo.toml">
  ```toml file="<root>/codes/static-dir-list/Cargo.toml"
  ```
  </Tab>
</Tabs>
  最初のフォルダに対応するファイルが見つからない場合、2番目のフォルダで検索します。

- `rust-embed` のサポートを提供します。例：
<Tabs>
  <Tab label="main.rs">
  ```rust file="<root>/codes/static-embed-files/src/main.rs"
  ```
  </Tab>
  <Tab label="Cargo.toml">
  ```toml file="<root>/codes/static-embed-files/Cargo.toml"
  ```
  </Tab>
</Tabs>
  `with_fallback` を使用すると、ファイルが見つからない場合に指定したファイルで代替できます。これは一部のシングルページアプリケーション（SPA）で有用です。
{/* Auto generated, origin file hash:19063883c45fafc63ab4ff3751ac9892 */}