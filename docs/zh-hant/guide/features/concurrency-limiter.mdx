import { Tab, Tabs } from 'rspress/theme';
import ConcurrencyLimiterCode from '../../../../codes_md/concurrency-limiter/src/main.mdx';
import ConcurrencyLimiterCargoCode from '../../../../codes_md/concurrency-limiter/Cargo.mdx';

# 限制並發數

Concurrency Limiter 中介軟體可以控制同時並發的請求數量。具體 API 請[查看文件](https://docs.rs/salvo_extra/latest/salvo_extra/concurrency_limiter/index.html)。

## 應用場景

在以下場景中，並發限制器特別有用：

- **高流量網站防護**：在流量突增時限制同時處理的請求數量，防止伺服器過載
- **資源密集型操作控制**：限制如檔案上傳、資料庫寫入等資源密集型操作的並發數
- **第三方API呼叫限制**：當需要呼叫有速率限制的外部服務時，控制並發請求數

## 主要作用

- **防止伺服器過載**：通過限制並發請求數，在流量高峰期保持伺服器穩定
- **提高系統可靠性**：避免資源耗盡導致的系統崩潰
- **優化資源分配**：確保關鍵服務有足夠資源處理請求

## 使用方法

只需在路由上添加 `max_concurrency(n)` 中介軟體，其中 `n` 是允許的最大並發請求數。超過此限制的請求將收到 `503 Service Unavailable` 回應。

_**範例程式碼**_

<Tabs>
  <Tab label="main.rs">
    <ConcurrencyLimiterCode/>
  </Tab>
  <Tab label="Cargo.toml">
    <ConcurrencyLimiterCargoCode/>
  </Tab>
</Tabs>
{/* 本行由工具自动生成,原文哈希值:764c09662183beca5fb5634badcad7bb */}